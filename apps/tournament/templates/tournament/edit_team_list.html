{% extends "tournament/owner_base.html" %}

{% load staticfiles %}
{% load profile_extras %}

{% block extra_head %}
    {{ block.super }}
    <script type="text/javascript" src="{% static "main/js/cookie.js" %}"></script>
    <script type="text/javascript" src="{% static "main/js/ajaxCSRF.js" %}"></script>
    <script type="text/javascript" src="{% static "tournament/js/main.js" %}"></script>
{% endblock extra_head %}


{% block page_title %}
    Список команд
{% endblock page_title %}


{% block content %}

        <div id="message"></div>
        <form
                 action={% if is_check_page %}
                            "{% url "tournament:check_team_list" tournament.id %}"
                        {% else %}
                            "{% url "tournament:edit_team_list" tournament.id %}"
                        {% endif %}
                method="post"
        >
        {% csrf_token %}
        {% for rel in forms %}
            <div id="errors_{{ rel.team.id }}"></div>
            <div id="team_{{ rel.team.id }}">
                <div class="row">
                    <div class="col s4">
                        <label>Название команды</label>
                        <p>{{ rel.team.name }}</p>
                    </div>
                    <div class=" col s4">
                        {{ rel.team_form.role }}
                    </div>
                    {% if can_remove_teams %}
                    <div>
                        <button
                                type="button"
                                onclick="remove_team(
                                        '{% url 'tournament:remove_team' tournament.id %}',
                                        {{ rel.team.id }},
                                        'team_{{ rel.team.id }}',
                                        'errors_{{ rel.team.id }}'
                                        )"
                                value="Удалить"
                        >
                            Удалить
                        </button>
                    </div>
                    {% endif %}
                </div>
                <div class="row">
                    <div class="col s3">
                        <label>Первый спикер:</label>
                        {{ rel.team.speaker_1|name }}
                    </div>
                    <div class="col s3">
                        <label>Второй спикер:</label>
                        {{ rel.team.speaker_2|name }}
                    </div>
                </div>
            </div>
            <hr>
        {% endfor %}

        {% if is_check_page %}
            <div class="row">
                <div class="col s8">
                    <label>Количество команд должно быть кратно 4 (сейчас {{ member_count }})</label>
                    {# TODO Изменять в js кол-во команд #}
                </div>
            </div>
        {% endif %}

        <div class="row">
            <button type="submit" class="waves-effect waves-light btn">
                {% if is_check_page %}
                    Далее
                {% else %}
                    Сохранить
                {% endif %}
            </button>
        </div>

    </form>

{% endblock content %}
